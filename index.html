<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Table</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="container container-lg">
        <div class="row">
            <div class="col-lg-12">
                <table class="table table-bordered">
                    <thead >
                      <tr>
                            <th class="bg-light text-center align-middle" rowspan="3">Period Date</th>
                            <th class="bg-light text-center align-middle" rowspan="3">Vessel</th>
                            <th class="bg-light text-center align-middle" rowspan="3">TC</th>
                            <th class="bg-light text-center" colspan="5">Charter Out</th>
                            <th class="bg-light text-center align-middle" rowspan="3">Freight</th>
                            <th class="bg-light text-center align-middle" rowspan="2" colspan="2">Other</th>
                            <th class="bg-light text-center align-middle" rowspan="3">Total Income</th>
                            <th class="bg-light text-center align-middle" rowspan="3">Del</th>
                      </tr>
                      <tr >
                            <th class="bg-light text-center align-middle" rowspan="2">Fixing WS(%)</th>
                            <th class="bg-light text-center align-middle" rowspan="2">Est.Flat rate($/MT)</th>
                            <th class="bg-light text-center align-middle" rowspan="2">Min Loaded($/MT)</th>
                            <th class="bg-light text-center" colspan="2">% Commission</th>
                        </tr>
                        <tr>
                            <th class="bg-light text-center"  rowspan="2">Detail</th>
                            <th class="bg-light text-center"  rowspan="2">Value</th>
                            <th class="bg-light text-center"  rowspan="2">Desc</th>
                            <th class="bg-light text-center"  rowspan="2">Amount</th>
                      </tr>
                    </thead>
                    <tbody>
                        <tr data-row="" id="row0">
                            <td><input type="text" name="period[]" class="form-control form-control-sm"></td>
                            <td><input type="text" name="vessel[]" class="form-control form-control-sm"></td>
                            <td><input type="text" name="tc[]" class="form-control form-control-sm"></td>
                            <td><input type="text" name="fixing[]" class="form-control form-control-sm"></td>
                            <td><input type="text" name="flat[]" class="form-control form-control-sm"></td>
                            <td><input type="text" name="min-load[]" class="form-control form-control-sm"></td>
                            <td>
                                <input type="text" name="detail[]" class="form-control form-control-sm">
                                <div class="text-center mt-1"><button class="btn btn-light btn-sm add-detail"><i class="fa-solid fa-plus"></i></button></div>
                            </td>
                            <td>
                                <input type="text" name="value[]" class="form-control form-control-sm">
                                <div class="text-center mt-1"><button class="btn btn-light btn-sm del-detail"><i class="fa-solid fa-minus"></i></button></div>
                            </td>
                            <td><input type="text" name="frieght[]" class="form-control form-control-sm"></td>
                            <td>
                                <input type="text" name="desc[]" class="form-control form-control-sm">
                                <div class="text-center mt-1"><button class="btn btn-light btn-sm add-other"><i class="fa-solid fa-plus"></i></button></div>
                            </td>
                            <td>
                                <input type="text" name="amont[]" class="form-control form-control-sm">
                                <div class="text-center mt-1"><button class="btn btn-light btn-sm del-other"><i class="fa-solid fa-minus"></i></button></div>
                            </td>
                            <td><input type="text" name="total[]" class="form-control form-control-sm"></td>
                            <td><button class="btn btn-light btn-sm del-row"><i class="fa-solid fa-trash"></i></button></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="13" class="right bg-light"><div class="d-flex justify-content-end"><button class="btn btn-secondary btn-sm add-row">Add Row+</button></div></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        var table = document.getElementsByTagName('table')[0];
        document.addEventListener('click',function(e){
            const addRow = e.target.closest('.add-row');
            if(addRow){
                const rowDefault = document.createElement('tr');
                rowDefault.innerHTML = `<td><input type="text" name="period[]" class="form-control form-control-sm"></td>
                <td><input type="text" name="vessel[]" class="form-control form-control-sm"></td>
                <td><input type="text" name="tc[]" class="form-control form-control-sm"></td>
                <td><input type="text" name="fixing[]" class="form-control form-control-sm"></td>
                <td><input type="text" name="flat[]" class="form-control form-control-sm"></td>
                <td><input type="text" name="min-load[]" class="form-control form-control-sm"></td>
                <td>
                    <input type="text" name="detail[]" class="form-control form-control-sm">
                    <div class="text-center mt-1"><button class="btn btn-light btn-sm add-detail"><i class="fa-solid fa-plus"></i></button></div>
                </td>
                <td>
                    <input type="text" name="value[]" class="form-control form-control-sm">
                    <div class="text-center mt-1"><button class="btn btn-light btn-sm del-detail"><i class="fa-solid fa-minus"></i></button></div>
                </td>
                <td><input type="text" name="frieght[]" class="form-control form-control-sm"></td>
                <td>
                    <input type="text" name="desc[]" class="form-control form-control-sm">
                    <div class="text-center mt-1"><button class="btn btn-light btn-sm add-other"><i class="fa-solid fa-plus"></i></button></div>
                </td>
                <td>
                    <input type="text" name="amount[]" class="form-control form-control-sm">
                    <div class="text-center mt-1"><button class="btn btn-light btn-sm del-other"><i class="fa-solid fa-minus"></i></button></div>
                </td>
                <td><input type="text" name="total[]" class="form-control form-control-sm"></td>
                <td><button class="btn btn-light btn-sm del-row"><i class="fa-solid fa-trash"></i></button></td>`;
                table.querySelector('tbody').append(rowDefault)
            }
            const delRow = e.target.closest('.del-row');
            if(delRow){
                delRow.closest('tr').remove();
            }
            const addDetail = e.target.closest('.add-detail');
            if(addDetail){

                const detail = document.createElement('input');
                detail.name = "detail[]";
                detail.classList.add("form-control","form-control-sm","mt-1");

                const value = document.createElement('input');
                value.name = "value[]";
                value.classList.add("form-control","form-control-sm","mt-1");

                const detailDiv = addDetail.closest('div');
                const detailTd = addDetail.closest('td');

                const valueTd = detailTd.nextElementSibling;
                const valueDiv = valueTd.querySelector('.text-center');

                detailTd.insertBefore(detail,detailDiv)
                valueTd.insertBefore(value,valueDiv)
            }
            const delDetail = e.target.closest('.del-detail');
            if(delDetail){

                const valueDiv = delDetail.closest('div');
                const valueTd = delDetail.closest('td');

                const detailTd = valueTd.previousElementSibling;
                const detailDiv = valueTd.querySelector('.text-center');
                
                const allValue = valueTd.querySelectorAll('.form-control');
                const allDetail = detailTd.querySelectorAll('.form-control');
                const all = allValue.length || 0;
                if(all>1){
                    allValue.forEach((v,k)=>{ if((all-1) == k) v.remove();  });
                    allDetail.forEach((v,k)=>{ if((all-1) == k) v.remove();  });
                }

            }

            const addOther = e.target.closest('.add-other');
            if(addOther){

                const desc = document.createElement('input');
                desc.name = "desc[]";
                desc.classList.add("form-control","form-control-sm","mt-1");

                const amount = document.createElement('input');
                amount.name = "amount[]";
                amount.classList.add("form-control","form-control-sm","mt-1");

                const descDiv = addOther.closest('div');
                const descTd = addOther.closest('td');

                const amountTd = descTd.nextElementSibling;
                const amountDiv = amountTd.querySelector('.text-center');

                descTd.insertBefore(desc,descDiv)
                amountTd.insertBefore(amount,amountDiv)

            }
            const delOther = e.target.closest('.del-other');
            if(delOther){

                const amountDiv = delOther.closest('div');
                const amountTd = delOther.closest('td');

                const descTd = amountTd.previousElementSibling;
                const descDiv = amountTd.querySelector('.text-center');
                
                const allAmount = amountTd.querySelectorAll('.form-control');
                const allDesc = descTd.querySelectorAll('.form-control');
                const all = allAmount.length || 0;

                if(all>1){
                    allAmount.forEach((v,k)=>{ if((all-1) == k) v.remove();  });
                    allDesc.forEach((v,k)=>{ if((all-1) == k) v.remove();  });
                }
            }
        })
    </script>
</body>
</html>